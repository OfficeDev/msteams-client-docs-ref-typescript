### YamlMime:TSType
name: AI
uid: '@microsoft/teams-ai.AI'
package: '@microsoft/teams-ai'
summary: AI System.
fullName: AI<TState>
remarks: >-
  The AI system is responsible for generating plans, moderating input and
  output, and

  generating prompts. It can be used free standing or routed to by the
  Application object.
isDeprecated: false
type: class
constructors:
  - name: AI<TState>(AIOptions<TState>)
    uid: '@microsoft/teams-ai.AI.constructor'
    package: '@microsoft/teams-ai'
    summary: Creates a new AI system.
    remarks: ''
    isDeprecated: false
    syntax:
      content: 'new AI(options: AIOptions<TState>)'
      parameters:
        - id: options
          type: <xref uid="@microsoft/teams-ai.AIOptions" />&lt;TState&gt;
          description: The options used to configure the AI system.
properties:
  - name: DoCommandActionName
    uid: '@microsoft/teams-ai.AI.DoCommandActionName'
    package: '@microsoft/teams-ai'
    summary: An action that is called to DO an action.
    fullName: DoCommandActionName
    remarks: >-
      The action system is used to do other actions. Overriding this action lets
      you customize the

      execution of an individual action. You can use it to log actions being
      used or to prevent

      certain actions from being executed based on policy.


      The default behavior is to simply execute the action handler passed in so
      you will need to

      perform that logic yourself should you override this action.
    isDeprecated: false
    syntax:
      content: 'static DoCommandActionName: "___DO___" = "___DO___"'
      return:
        description: ''
        type: '"___DO___"'
  - name: FlaggedInputActionName
    uid: '@microsoft/teams-ai.AI.FlaggedInputActionName'
    package: '@microsoft/teams-ai'
    summary: >-
      An action that will be called anytime an input is flagged by the
      moderator.
    fullName: FlaggedInputActionName
    remarks: >-
      The default behavior is to simply log an error to the console. Override to
      send a custom

      message to the user.
    isDeprecated: false
    syntax:
      content: >-
        static FlaggedInputActionName: "___FlaggedInput___" =
        "___FlaggedInput___"
      return:
        description: ''
        type: '"___FlaggedInput___"'
  - name: FlaggedOutputActionName
    uid: '@microsoft/teams-ai.AI.FlaggedOutputActionName'
    package: '@microsoft/teams-ai'
    summary: >-
      An action that will be called anytime an output is flagged by the
      moderator.
    fullName: FlaggedOutputActionName
    remarks: >-
      The default behavior is to simply log an error to the console. Override to
      send a custom

      message to the user.
    isDeprecated: false
    syntax:
      content: >-
        static FlaggedOutputActionName: "___FlaggedOutput___" =
        "___FlaggedOutput___"
      return:
        description: ''
        type: '"___FlaggedOutput___"'
  - name: moderator
    uid: '@microsoft/teams-ai.AI.moderator'
    package: '@microsoft/teams-ai'
    summary: Returns the moderator being used by the AI system.
    fullName: moderator
    remarks: ''
    isDeprecated: false
    syntax:
      content: Moderator<TState> moderator
      return:
        description: ''
        type: <xref uid="@microsoft/teams-ai.Moderator" />&lt;TState&gt;
  - name: options
    uid: '@microsoft/teams-ai.AI.options'
    package: '@microsoft/teams-ai'
    summary: Returns the configured options for the AI system.
    fullName: options
    remarks: ''
    isDeprecated: false
    syntax:
      content: ConfiguredAIOptions<TState> options
      return:
        description: ''
        type: <xref uid="@microsoft/teams-ai.ConfiguredAIOptions" />&lt;TState&gt;
  - name: planner
    uid: '@microsoft/teams-ai.AI.planner'
    package: '@microsoft/teams-ai'
    summary: Returns the planner being used by the AI system.
    fullName: planner
    remarks: ''
    isDeprecated: false
    syntax:
      content: Planner<TState> planner
      return:
        description: ''
        type: <xref uid="@microsoft/teams-ai.Planner" />&lt;TState&gt;
  - name: PlanReadyActionName
    uid: '@microsoft/teams-ai.AI.PlanReadyActionName'
    package: '@microsoft/teams-ai'
    summary: >-
      An action that will be called after the plan has been predicted by the
      planner and it has

      passed moderation.
    fullName: PlanReadyActionName
    remarks: >-
      Overriding this action lets you customize the decision to execute a plan
      separately from the

      moderator. The default behavior is to proceed with the plans execution
      only with a plan

      contains one or more commands. Returning false from this action can be
      used to prevent the plan

      from being executed.
    isDeprecated: false
    syntax:
      content: 'static PlanReadyActionName: "___PlanReady___" = "___PlanReady___"'
      return:
        description: ''
        type: '"___PlanReady___"'
  - name: prompts
    uid: '@microsoft/teams-ai.AI.prompts'
    package: '@microsoft/teams-ai'
    summary: Returns the prompt manager being used by the AI system.
    fullName: prompts
    remarks: ''
    isDeprecated: false
    syntax:
      content: PromptManager<TState> prompts
      return:
        description: ''
        type: <xref uid="@microsoft/teams-ai.PromptManager" />&lt;TState&gt;
  - name: RateLimitedActionName
    uid: '@microsoft/teams-ai.AI.RateLimitedActionName'
    package: '@microsoft/teams-ai'
    summary: An action that will be called anytime the planner is rate limited.
    fullName: RateLimitedActionName
    remarks: ''
    isDeprecated: false
    syntax:
      content: 'static RateLimitedActionName: "___RateLimited___" = "___RateLimited___"'
      return:
        description: ''
        type: '"___RateLimited___"'
  - name: SayCommandActionName
    uid: '@microsoft/teams-ai.AI.SayCommandActionName'
    package: '@microsoft/teams-ai'
    summary: An action that is called to SAY something.
    fullName: SayCommandActionName
    remarks: >-
      Overriding this action lets you customize the execution of the SAY
      command. You can use it

      to log the output being generated or to add support for sending certain
      types of output as

      message attachments.


      The default behavior attempts to look for an Adaptive Card in the output
      and if found sends

      it as an attachment. If no Adaptive Card is found then the output is sent
      as a plain text

      message.


      If you override this action and want to automatically send Adaptive Cards
      as attachments you

      will need to handle that yourself.
    isDeprecated: false
    syntax:
      content: 'static SayCommandActionName: "___SAY___" = "___SAY___"'
      return:
        description: ''
        type: '"___SAY___"'
  - name: UnknownActionName
    uid: '@microsoft/teams-ai.AI.UnknownActionName'
    package: '@microsoft/teams-ai'
    summary: >-
      An action that will be called anytime an unknown action is predicted by
      the planner.
    fullName: UnknownActionName
    remarks: >-
      The default behavior is to simply log an error to the console. The plan is
      allowed to

      continue execution by default.
    isDeprecated: false
    syntax:
      content: 'static UnknownActionName: "___UnknownAction___" = "___UnknownAction___"'
      return:
        description: ''
        type: '"___UnknownAction___"'
methods:
  - name: >-
      action<TEntities>(string | string[], (context: TurnContext, state: TState,
      entities: TEntities, action?: string) => Promise<boolean>, boolean)
    uid: '@microsoft/teams-ai.AI.action'
    package: '@microsoft/teams-ai'
    summary: Registers a handler for a named action.
    remarks: >-
      The AI systems planner returns plans that are made up of a series of
      commands or actions

      that should be performed. Registering a handler lets you provide code that
      should be run in

      response to one of the predicted actions.


      Plans support a DO command which specifies the name of an action to call
      and an optional

      set of entities that should be passed to the action. The internal plan
      executor will call

      the registered handler for the action passing in the current context,
      state, and entities.


      Additionally, the AI system itself uses actions to handle things like
      unknown actions,

      flagged input, and flagged output. You can override these actions by
      registering your own

      handler for them. The names of the built-in actions are available as
      static properties on

      the AI class.
    isDeprecated: false
    syntax:
      content: >-
        function action<TEntities>(name: string | string[], handler: (context:
        TurnContext, state: TState, entities: TEntities, action?: string) =>
        Promise<boolean>, allowOverrides?: boolean): AI<TState>
      parameters:
        - id: name
          type: string | string[]
          description: Unique name of the action.
        - id: handler
          type: >-
            (context: TurnContext, state: TState, entities: TEntities, action?:
            string) =&gt; Promise&lt;boolean&gt;
          description: Function to call when the action is triggered.
        - id: allowOverrides
          type: boolean
          description: >-
            Optional. If true, this handler is allowed to be overridden.
            Defaults to false.
      return:
        description: The AI system instance for chaining purposes.
        type: <xref uid="@microsoft/teams-ai.AI" />&lt;TState&gt;
  - name: >-
      chain(TurnContext, TState, string | PromptTemplate,
      Partial<AIOptions<TState>>)
    uid: '@microsoft/teams-ai.AI.chain'
    package: '@microsoft/teams-ai'
    summary: Chains into another prompt and executes the plan that is returned.
    remarks: >-
      This method is used to chain into another prompt. It will call the prompt
      manager to

      get the plan for the prompt and then execute the plan. The return value
      indicates whether

      that plan was completely executed or not, and can be used to make
      decisions about whether the

      outer plan should continue executing.
    isDeprecated: false
    syntax:
      content: >-
        function chain(context: TurnContext, state: TState, prompt?: string |
        PromptTemplate, options?: Partial<AIOptions<TState>>): Promise<boolean>
      parameters:
        - id: context
          type: TurnContext
          description: Current turn context.
        - id: state
          type: TState
          description: Current turn state.
        - id: prompt
          type: string | <xref uid="@microsoft/teams-ai.PromptTemplate" />
          description: >-
            Optional. Prompt name or prompt template to use. If omitted, the AI
            systems default prompt will be used.
        - id: options
          type: >-
            Partial&lt;<xref uid="@microsoft/teams-ai.AIOptions"
            />&lt;TState&gt;&gt;
          description: >-
            Optional. Override options for the prompt. If omitted, the AI
            systems configured options will be used.
      return:
        description: True if the plan was completely executed, otherwise false.
        type: Promise&lt;boolean&gt;
  - name: >-
      completePrompt(TurnContext, TState, string | PromptTemplate,
      Partial<AIOptions<TState>>)
    uid: '@microsoft/teams-ai.AI.completePrompt'
    package: '@microsoft/teams-ai'
    summary: A helper method to complete a prompt using the configured prompt manager.
    remarks: ''
    isDeprecated: false
    syntax:
      content: >-
        function completePrompt(context: TurnContext, state: TState, prompt:
        string | PromptTemplate, options?: Partial<AIOptions<TState>>):
        Promise<undefined | string>
      parameters:
        - id: context
          type: TurnContext
          description: Current turn context.
        - id: state
          type: TState
          description: Current turn state.
        - id: prompt
          type: string | <xref uid="@microsoft/teams-ai.PromptTemplate" />
          description: Prompt name or prompt template to use.
        - id: options
          type: >-
            Partial&lt;<xref uid="@microsoft/teams-ai.AIOptions"
            />&lt;TState&gt;&gt;
          description: >-
            Optional. Override options for the prompt. If omitted, the AI
            systems configured options will be used.
      return:
        description: >-
          The result of the prompt. If the prompt was not completed (typically
          due to rate limiting), the return value will be undefined.
        type: Promise&lt;undefined | string&gt;
  - name: createSemanticFunction(string, PromptTemplate, Partial<AIOptions<TState>>)
    uid: '@microsoft/teams-ai.AI.createSemanticFunction'
    package: '@microsoft/teams-ai'
    summary: >-
      Creates a semantic function that can be registered with the apps prompt
      manager.
    remarks: >-
      Semantic functions are functions that make model calls and return their
      results as template

      parameters to other prompts. For example, you could define a semantic
      function called

      'translator' that first translates the user's input to English before
      calling your main prompt:


      ```JavaScript

      app.ai.prompts.addFunction('translator',
      app.ai.createSemanticFunction('translator-prompt'));

      ```


      You would then create a prompt called "translator-prompt" that does the
      translation and then in

      your main prompt you can call it using the template expression
      `{{translator}}`.
    isDeprecated: false
    syntax:
      content: >-
        function createSemanticFunction(name: string, template?: PromptTemplate,
        options?: Partial<AIOptions<TState>>): (context: TurnContext, state:
        TState) => Promise<any>
      parameters:
        - id: name
          type: string
          description: ''
        - id: template
          type: <xref uid="@microsoft/teams-ai.PromptTemplate" />
          description: ''
        - id: options
          type: >-
            Partial&lt;<xref uid="@microsoft/teams-ai.AIOptions"
            />&lt;TState&gt;&gt;
          description: ''
      return:
        description: ''
        type: '(context: TurnContext, state: TState) =&gt; Promise&lt;any&gt;'
  - name: doAction<TEntities>(TurnContext, TState, string, TEntities)
    uid: '@microsoft/teams-ai.AI.doAction'
    package: '@microsoft/teams-ai'
    summary: Manually executes a named action.
    remarks: ''
    isDeprecated: false
    syntax:
      content: >-
        function doAction<TEntities>(context: TurnContext, state: TState,
        action: string, entities?: TEntities): Promise<boolean>
      parameters:
        - id: context
          type: TurnContext
          description: Current turn context.
        - id: state
          type: TState
          description: Current turn state.
        - id: action
          type: string
          description: Name of the action to execute.
        - id: entities
          type: TEntities
          description: Optional. Entities to pass to the action.
      return:
        description: True if the action thinks other actions should be executed.
        type: Promise&lt;boolean&gt;
